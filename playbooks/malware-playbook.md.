# Malware Incident Response Playbook

**ID:** SOC-PB-002
**Tactic:** Execution, Persistence
**MITRE ATT&CK Techniques:** [T1204 - User Execution](https://attack.mitre.org/techniques/T1204/), [T1059 - Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059/)

## Overview
This playbook provides a structured response to alerts indicating a malware infection on an endpoint. The goal is to quickly contain the infected machine, analyze the malware, and eradicate it from the environment.

### Severity Levels
* **Low:** Non-critical endpoint infected with known adware or commodity malware.
* **Medium:** Standard user endpoint infected with a trojan or suspected backdoor; potential for lateral movement.
* **High:** Critical server or high-privilege user endpoint infected with ransomware, a worm, or an unknown malware variant (potential zero-day).

### Flowchart
```mermaid
graph TD
    subgraph Detection
        A[EDR Alert: Malicious File Detected]
    end

    subgraph Investigation
        A --> B{Get File Hash & Hostname âš¡};
        B --> C{Check Hash Reputation (e.g., VirusTotal) âš¡};
        C --> D{Analyze Process Execution & Network Logs ğŸ‘¨};
    end

    subgraph Containment
        D --> E[Isolate Endpoint from Network via EDR âš¡];
        E --> F[Suspend User Account if Active ğŸ‘¨];
    end

    subgraph Eradication
        F --> G[Kill Malicious Process & Delete File via EDR âš¡];
        G --> H[Block Malware Hash in EDR/AV âš¡];
        H --> I[Scan Environment for Same Hash ğŸ‘¨];
    end

    subgraph Recovery
        I --> J{Is Endpoint Clean? ğŸ‘¨};
        J -- Yes --> K[Reconnect Endpoint to Network âš¡];
        J -- No --> L[Re-image Endpoint from Gold Master ğŸ‘¨];
        L --> K;
        K --> M[Re-enable User Account ğŸ‘¨];
    end

    subgraph Post-Incident
        M --> N[Document Findings & Root Cause ğŸ‘¨];
        N --> O[Submit Malware Sample for Analysis ğŸ‘¨];
    end
